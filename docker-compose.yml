version: '3.8'

services:
  api:
    # Build the image using the Dockerfile
    build: .
    container_name: glasses-backend
    
    # Map local port 3000 to container port 3000
    ports:
      - "3000:3000"
      
    # Read environment variables from the .env file
    env_file:
      - ./.env 
      
    # volumes: Critical for hot-reload/fast development.
    # 1. Bind local code to /app in container so changes are reflected immediately.
    # 2. Exclude node_modules to prevent host modules from mixing with container modules.
    volumes:
      - .:/app 
      - /app/node_modules 
      
    # Command: Start in fast development mode with ts-node-dev
    command: npm run dev